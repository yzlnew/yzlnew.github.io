<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>N5095 All in One 折腾记 - 黄石的时空回环</title><link rel=icon type=image/png href=/img/favicon.png><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="N5095 All in One 折腾记"><meta itemprop=description content="人生苦短，折腾起来"><meta itemprop=datePublished content="2022-06-10T00:00:00+00:00"><meta itemprop=dateModified content="2022-06-10T00:00:00+00:00"><meta itemprop=wordCount content="868"><meta itemprop=keywords content="软路由,家庭网络,"><meta property="og:title" content="N5095 All in One 折腾记"><meta property="og:description" content="人生苦短，折腾起来"><meta property="og:type" content="article"><meta property="og:url" content="https://yzlnew.com/2022/06/n5095-aio/"><meta property="article:published_time" content="2022-06-10T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-10T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="N5095 All in One 折腾记"><meta name=twitter:description content="人生苦短，折腾起来"><link href="https://fonts.googleapis.com/css?family=Playfair+Display:700" rel=stylesheet type=text/css><link rel=stylesheet type=text/css media=screen href=https://yzlnew.com/css/main.css><link rel=stylesheet type=text/css href=https://yzlnew.com/css/custom.css><link id=dark-scheme rel=stylesheet type=text/css href=https://yzlnew.com/css/dark.css><link id=dark-scheme rel=stylesheet type=text/css href=https://yzlnew.com/css/custom_dark.css><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://yzlnew.com/js/main.js></script></head><body><div class="container wrapper"><div class=header><div class=avatar><a href=https://yzlnew.com/><img src=/img/avatar.png alt=黄石的时空回环></a></div><h1 class=site-title><a href=https://yzlnew.com/>黄石的时空回环</a></h1><div class=site-description><p>Let me fly to the 🌕️</p></div><nav class=nav><ul class=flat><li><a href=/>主页</a></li><li><a href=/about>关于我</a></li><li><a href=/tags>标签</a></li></ul></nav></div><div class=sidebar><h4>文章目录</h4><nav id=TableOfContents><ul><li><a href=#主系统选什么>主系统选什么</a></li><li><a href=#jellyfin-核显硬解>Jellyfin 核显硬解</a></li><li><a href=#有哪些自建服务>有哪些自建服务</a></li></ul></nav></div><div class=post><article><div class=post-header><div class=matter><h1 class=title>N5095 All in One 折腾记</h1><div class=meta><span class=date>2022-06-10</span>
<span class="busuanzi page" id=busuanzi_container_page_pv><div class=tags><ul class=flat><li><a href=/tags/%E8%BD%AF%E8%B7%AF%E7%94%B1>软路由</a></li><li><a href=/tags/%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C>家庭网络</a></li></ul></div></div></div></div></article><div class=markdown><p>最近 618，机缘巧合在 smzdm 评论区看到最近有台小主机很火热，就是带 4 个 2.5G 网口的 N5095。家里目前有的设备包括：</p><ul><li>QNAP TS-451D：四盘位 J4025 的 NAS，二核性能一般，上面跑了不少 Docker 服务。</li><li>小米 AX3600：作为主路由，刷了 Openwrt 并且改了 1G 的内存，其实完全满足我的需求了。</li></ul><p>六月初的时候看到 N5095 准系统只要 665，就顺势拿下了（其实应该更应该买 N5105 的，贵几十，但是核显性能更好一点）。顺便买了内存和硬盘，都是在京东挑便宜的买，然后因为据说这个模具散热不好，又再 PDD 花 10 块钱买了个小风扇。总的成本在 1000 以下。</p><p><img src=https://raw.githubusercontent.com/yzlnew/ImageBed/master/blog/2022/n5095-hardware.jpg alt=N5095></p><p>没想到短短几天就有猫毛在风扇上了，囧rz。</p><h2 id=准备工作>准备工作</h2><p>自从上次玩 AX3600 固件 BOOM 了之后，越发觉得在硬路由上搞一些骚操作有点太为难自己了。买 N5095 主要也是需要一个软路由，另外把 NAS 上一些服务迁移到上面，减少点负担。</p><p>在硬件到货之前，先看了几个 up 主的视频，完全从零开始看司波图[1]的就挺好。基本能搞明白这台软路由在家庭网络里面的位置。刚好他的拓扑比较符合我的需求，我没有也不需要一个交换机。大致的网络拓扑如下所示：</p><p><img src=https://raw.githubusercontent.com/yzlnew/ImageBed/master/blog/2022/n5095-aio.png alt="Network Overview"></p><h2 id=几个小问题>几个小问题</h2><h3 id=主系统选什么>主系统选什么</h3><p>宿主系统可以选 <a href=https://www.proxmox.com/en/>Proxmox VE</a>、<a href=https://www.vmware.com/products/esxi-and-esx.html>VMware ESXi</a>、<a href=https://www.microsoft.com/en-us/windows-server>Windows Server 2022</a>等等，看个人喜好了，甚至装个 Arch、Ubuntu 之类的都可以。之前没有太多的了解，看上去 PVE 的管理比较简单，另外参考<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，如果要核显直通的话可以选 Win Server。</p><h3 id=jellyfin-核显硬解>Jellyfin 核显硬解</h3><p>这算是这几个 11 代 U 比较坑的点，它们是<a href=https://www.intel.com/content/www/us/en/support/articles/000058558/graphics.html>不支持 GVT-g</a> 的，核显不能直通给虚拟机。在 PVE 下要核显硬解的话，也就两个方案：</p><ol><li>LXC 下装 Debian，里面用 Beta 版的 Jellyfin，推荐 <code>nyanmisaka/jellyfin</code> 这个镜像<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，里面打了核显驱动和一些中文本地化优化。另外只要强制开启转码就可以了<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>。</li><li>核显指派给 LXC，在 Debian 里裸装 Jellyfin<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>。</li></ol><p>我比较倾向于方案一，看视频效率比较低，可以直接看 Jellyfin 的官方硬解文档<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>。</p><h3 id=有哪些自建服务>有哪些自建服务</h3><p>查看 <a href=https://github.com/awesome-selfhosted/awesome-selfhosted>Awesome-Selfhosted</a>。目前我把 PT 下载、aria2 和 Nextcloud 留在 NAS 上，Home Assistant、Jellyfin 迁移到了 N5095 上，另外上面还有 frp 的反代。</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://www.bilibili.com/video/BV18L4y1F7gN>系统安装及核显硬解</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=https://www.bilibili.com/read/cv14514123>Jellyfin 中国特供版</a> <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><a href=https://www.bilibili.com/video/BV1sB4y197RS>PVE 下 Jellyfin 核显硬解</a> <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p><a href=https://www.bilibili.com/video/BV1dY4y137PB>PVE 下核显硬解</a> <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p><a href=https://jellyfin.org/docs/general/administration/hardware-acceleration.html#intel-gen9-and-gen11-igpus>Hardware Acceleration</a> <a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class=page-visit># 本文一共被访问了 <span id=busuanzi_value_page_pv></span>&nbsp;次。</span></div><div id=utter-container></div><script src=https://utteranc.es/client.js repo=yzlnew/yzlnew.github.io issue-term=title theme=github-light crossorigin=anonymous async></script></div></div><div class="footer wrapper"><div class=social-links><ul class=social-media-list><li><a href=mailto:yzlnew@gmail.com title=Mail><i data-feather=mail></i></a></li><li><a href=https://github.com/yzlnew title=Github><i data-feather=github></i></a></li><li><a href=https://t.me/r0brew title=Telegram><i data-feather=message-square></i></a></li><li><a href=/index.xml title=RSS><i data-feather=rss></i></a></li></ul></div><nav class=copyright><div>2022 © Copyright Ye Zhiling</div></nav><div class=site-visit><span id=busuanzi_container_site_pv><i data-feather=compass></i><span id=busuanzi_value_site_pv></span></span><span id=busuanzi_container_site_uv><i data-feather=users></i><span id=busuanzi_value_site_uv></span></span></div></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-61197619-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script>feather.replace()</script></body></html>